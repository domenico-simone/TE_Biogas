"0","vsd <- vst(dds.exp, blind = FALSE)"
"0",""
"0","# We use the R function *dist* to calculate the Euclidean distance between samples. To ensure we have a roughly equal contribution from all genes, we use it on the VST data. We need to transpose the matrix of values using t, because the dist function expects the different samples to be rows of its argument, and different dimensions (here, genes) to be columns."
"0","sampleDists <- dist(t(assay(vsd)))"
"0","# In order to plot the sample distance matrix with the rows/columns arranged by the distances in our distance matrix, we manually provide sampleDists to the clustering_distance argument of the pheatmap function. Otherwise the pheatmap function would assume that the matrix contains the data values themselves, and would calculate distances between the rows/columns of the distance matrix, which is not desired. We also manually specify a blue color palette using the colorRampPalette function from the RColorBrewer package."
"0","sampleDistMatrix <- as.matrix( sampleDists )"
"0","rownames(sampleDistMatrix) <- dds$Sample"
"0","colnames(sampleDistMatrix) <- NULL"
"0","colors <- colorRampPalette( rev(brewer.pal(9, ""Blues"")) )(255)"
"0","pheatmap(sampleDistMatrix,"
"0","clustering_distance_rows = sampleDists,"
"0","clustering_distance_cols = sampleDists,"
"0","col = colors)"
