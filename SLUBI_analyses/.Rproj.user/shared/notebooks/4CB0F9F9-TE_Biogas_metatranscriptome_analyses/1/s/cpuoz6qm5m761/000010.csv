"0","show.transform <- function(dds.exp){"
"0","## set blind = FALSE if the conditions are expected to introduce"
"0","## strong differences in a large proportion of the genes"
"0","vsd <- vst(dds.exp, blind = FALSE)"
"0","rld <- rlog(dds.exp, blind = FALSE)"
"0","dds <- estimateSizeFactors(dds.exp)"
"0","df <- bind_rows("
"0","  as_data_frame(log2(counts(dds, normalized=TRUE)[, 1:2]+1)) %>%"
"0","    mutate(transformation = ""log2(x + 1)""),"
"0","  as_data_frame(assay(vsd)[, 1:2]) %>% mutate(transformation = ""vst""),"
"0","  as_data_frame(assay(rld)[, 1:2]) %>% mutate(transformation = ""rlog""))"
"0",""
"0","  colnames(df)[1:2] <- c(""x"", ""y"")"
"0",""
"0","  lvls <- c(""log2(x + 1)"", ""vst"", ""rlog"")"
"0",""
"0","  df$transformation <- factor(df$transformation, levels=lvls)"
"0","  ggplot(df, aes(x = x, y = y)) + geom_hex(bins = 80) +"
"0","  coord_fixed() + facet_grid( . ~ transformation)"
"0","}"
"0","show.transform(dds.exp)"
